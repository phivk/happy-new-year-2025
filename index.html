<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.5.0/lib/p5.min.js"></script>
  </head>
  <body>
    <script>
      let clocks = [];
      let paused = true;
      let direction = 1; // 1 for forward, -1 for reverse
      let speed = 2; // base animation speed
      const MIN_SPEED = 0.5;
      const MAX_SPEED = 12;
      let cols = 8;
      let rows = 3;

      const clocks2025 = [
        // row 1
        [90, 90],
        [180, -90],
        [90, 180],
        [-90, 180],
        [90, 90],
        [180, -90],
        [180, 90],
        [-90, -90],
        // row 2
        [180, 90],
        [-90, 0],
        [0, 180],
        [0, 180],
        [180, 90],
        [-90, 0],
        [90, 0],
        [180, -90],
        // row 3
        [90, 0],
        [-90, -90],
        [0, 90],
        [0, -90],
        [90, 0],
        [-90, -90],
        [90, 90],
        [-90, 0],
      ];

      function initializeClocksRandom() {
        clocks = Array(cols * rows)
          .fill()
          .map(() => [
            random(360), // minute
            random(360), // hour
          ]);
      }

      function initializeClocksSpecific(clockData) {
        if (clockData.length !== cols * rows) {
          console.error(
            "Input array must match the number of clocks:",
            cols * rows
          );
          return;
        }
        clocks = [...clockData];
      }

      function setup() {
        createCanvas(windowWidth, windowHeight);
        initializeClocksSpecific(clocks2025);
      }

      function drawClock(sizeOfClock, clockAngles) {
        let clockStrokeWeight = 8;
        noStroke();
        ellipse(0, 0, sizeOfClock);
        stroke(0);
        strokeWeight(clockStrokeWeight);
        push();
        rotate(radians(clockAngles[1])); // hour
        line(0, 0, 0, -(sizeOfClock * 0.33 - clockStrokeWeight / 2));
        pop();
        push();
        rotate(radians(clockAngles[0])); // minute
        line(0, 0, 0, -(sizeOfClock * 0.5 - clockStrokeWeight / 2));
        pop();
      }

      function draw() {
        background(220);
        let clockSize = 50;
        let spacing = clockSize + 10;
        let startX = spacing;
        let startY = height / 2 - spacing;

        for (let i = 0; i < cols; i++) {
          for (let j = 0; j < rows; j++) {
            let idx = i + j * cols;
            push();
            translate(startX + i * spacing, startY + j * spacing);
            drawClock(clockSize, clocks[idx]);
            pop();

            if (!paused) {
              clocks[idx][0] += speed * direction; // minute
              clocks[idx][1] += (speed * direction) / 12; // hour
            }
          }
        }
      }

      function moveOneHour(forward = true) {
        const hourStep = forward ? 30 : -30; // 30 degrees = 1 hour
        const minuteStep = forward ? 360 : -360; // full circle for minute hand

        clocks.forEach((clock) => {
          clock[0] += minuteStep; // minute hand
          clock[1] += hourStep; // hour hand
        });
      }

      function keyPressed() {
        if ((key === "p") | (key === " ")) {
          paused = !paused;
        }
        if (key === "d") {
          direction *= -1; // Toggle between 1 and -1
        }
        if (keyCode === UP_ARROW) {
          speed = Math.min(speed + 0.5, MAX_SPEED);
        }
        if (keyCode === DOWN_ARROW) {
          speed = Math.max(speed - 0.5, MIN_SPEED);
        }
        if (keyCode === RIGHT_ARROW) {
          moveOneHour(true);
        }
        if (keyCode === LEFT_ARROW) {
          moveOneHour(false);
        }
      }

      function windowResized() {
        resizeCanvas(windowWidth, windowHeight);
      }
    </script>
  </body>
</html>
